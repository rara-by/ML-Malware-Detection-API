# ML-Malware-Detection-API
A malware classifier ML model trained with feature engineering, and deployed as a AWS SageMaker endpoint

This project explores building, deploying, and evaluating a machine learning model for malware detection using static analysis of Portable Executable (PE) files.  A random forest classifier is trained on features extracted from PE files and deployed as an API endpoint on AWS SageMaker.  A Python client interacts with the deployed model to classify new executable files.
Project Structure

   - **Building a Static Malware Detector.ipynb**: A Jupyter Notebook for feature extraction and model training and deployment.
   - **model/code**: Contains *entrypoint.py* (endpoint model loading and prediciton) and *requirements.txt* (project dependencies).
   - **model.joblib**: Stores the trained random forest model as a serialized file.
   - **client/**: Implements a Python client for interacting with the deployed model in *pyclient.py*, serialized featurizer objects: **imports_featurizer.joblib* and
              **section_names_featurizer.joblib*, dependecies: **requirements.txt*
  - **benchmark_ember/**: A Jupyeter Notebook to evaluate performance on sampled data from the [EMBER 2018](https://github.com/elastic/ember) dataset: *Building a Static Malware Detector-EMBER.ipynb**,
                    serialized model and featurizer objects: **imports_featurizer_e.joblib*, *model_e.joblib**, **section_names_featurizer_e.joblib*
  - **report.pdf**: A comprehensive report detailing the project methodology, results, and discussion.
   

Dependencies

This project requires the following Python libraries:

    sagemaker
    scikit-learn==1.2.1
    joblib 
    nltk 
    numpy
    pandas
    pefile
    matplotlib
    seaborn

Deployment on SageMaker

   - Upload the Model:
        Package the trained model (model.joblib) and any additional code from model/code into a TAR.GZ archive (e.g., model.tar.gz).
        Upload the archive to an S3 bucket accessible by your SageMaker session.

   - Deploy the Model:
        Set the environment variables SAGEMAKER_EXECUTION_ROLE and AWS_DEFAULT_REGION to point to your SageMaker execution role and region, respectively. The model is wrapped in AWS SageMaker's `SKLearnModel` wrapper. Endpoint payload is JSON serialized.

Using the Client

   - Run the Client:
        Create a AWS SageMaker endpoint for the model.
        Run pyclient.py with the path to a PE file as an argument.
        The script will extract features, send them to the deployed model, and display the prediction (malware or benign).

        `!python pyclient.py --sample 'path/to/PE_file.exe'`

Performance Benchmarking
   Evaluate the model's performance on the testing set using metrics like accuracy, precision, recall, and F1-score, and visualization of ROC AUC curve and Confusion Matrix.

[Project Presentation](https://youtu.be/AkIz0KX-Tpg)




